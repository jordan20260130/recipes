#!/bin/bash
# Recipes collection context

echo "# Recipes Collection"
echo ""
echo "## Contents"
echo ""

# List all .md files with titles (extract from filename or first H1)
for f in *.md; do
    if [ -f "$f" ]; then
        # Look for first # heading, or use filename
        title=$(grep -m1 '^# ' "$f" | sed 's/^# //' | head -1)
        if [ -z "$title" ]; then
            title=$(basename "$f" .md | tr '-' ' ' | sed 's/\b\(.\)/\u\1/')
        fi
        echo "- **$f** — $title"
    fi
done

echo ""
echo "## Stats"
echo "- Recipes: $(ls -1 *.md 2>/dev/null | wc -l)"
echo "- Last commit: $(git log -1 --format='%h %s' 2>/dev/null)"
echo ""

echo "## Food Safety Focus"
echo "Recipes in this collection include food safety notes where relevant."
echo "For pickling safety, see: https://www.healthycanning.com/50-50-rule-pickling/"
echo ""

echo "## Commands"
echo "- \`./ctx\` — show this context"
echo "- \`git log --oneline\` — view recipe history"
